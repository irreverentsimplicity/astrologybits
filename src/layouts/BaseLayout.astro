---
interface Props {
  page: any;
}

const { page } = Astro.props;

// Extract SEO data from Yoast
const seo = page.seo || {};

// Check if homepage
const isHomepage = page.uri === '/' || page.slug === 'home' || page.slug === 'homepage';

// Set title with fallback
const title = seo.title || page.title || 'Astrology Bits - Love compatibility, dating styles and love language';

// Set description with REQUIRED fallback
const description = seo.metaDesc || 
  (isHomepage 
    ? 'Love compatibility using traditional and AI assited astrological approaches. Sign by sign descriptions with advice and best strategies. '
    : 'Explore astrology insights and love compatibility scores at Astrology Bits.'
  );

const canonical = seo.canonical || `https://astrologybits.com${page.uri}`;
const ogTitle = seo.opengraphTitle || title;
const ogDescription = seo.opengraphDescription || description;
const ogImage = seo.opengraphImage?.sourceUrl || null;

// Parse schema markup
let schemaMarkup = null;
if (seo.schema?.raw) {
  try {
    schemaMarkup = JSON.parse(seo.schema.raw);
  } catch (e) {
    console.warn('Could not parse schema markup');
  }
}
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- SEO Meta Tags -->
  <title>{title}</title>
  <meta name="title" content={title}>
  <meta name="description" content={description}>
  <link rel="canonical" href={canonical}>
  
  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:url" content={canonical}>
  <meta property="og:title" content={ogTitle}>
  <meta property="og:description" content={ogDescription}>
  {ogImage && <meta property="og:image" content={ogImage}>}
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content={canonical}>
  <meta property="twitter:title" content={ogTitle}>
  <meta property="twitter:description" content={ogDescription}>
  {ogImage && <meta property="twitter:image" content={ogImage}>}
  
  <!-- Schema.org -->
  {schemaMarkup && (
    <script type="application/ld+json" set:html={JSON.stringify(schemaMarkup)} />
  )}
  
  <style is:global>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      line-height: 1.6;
      color: #333;
      background: #fff;
    }
    
    main {
      max-width: 800px;
      margin: 0 auto;
      padding: 2rem 1rem;
    }
    
    h1 { font-size: 2.5rem; margin: 0 0 1rem; }
    h2 { font-size: 1.8rem; margin: 1.5rem 0 0.5rem; }
    h3 { font-size: 1.4rem; margin: 1.5rem 0 0.5rem; }
    
    a { color: #2980b9; text-decoration: none; }
    a:hover { text-decoration: underline; }
    
    img { max-width: 100%; height: auto; }
    
    .wp-content p { margin-bottom: 1em; }
    .wp-content ul, .wp-content ol { margin: 1em 0 1em 1.5em; }

    .main-nav {
      max-width: 800px;
      margin: 1rem auto 0;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .main-nav > a {
      color: #fff;
      padding: 0.5rem 1rem;
      text-decoration: none;
      font-weight: 500;
    }

    .main-nav > a:hover {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
    }

    /* Dropdown */
    .nav-dropdown {
      position: relative;
      display: inline-block;
    }

    .nav-link {
      color: #fff;
      background: none;
      border: none;
      padding: 0.5rem 1rem;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      font-family: inherit;
    }

    .nav-link:hover {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
    }

    .dropdown-content {
      display: none;
      position: absolute;
      background-color: #34495e;
      min-width: 200px;
      box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
      z-index: 1;
      border-radius: 4px;
      margin-top: 0.25rem;
    }

    .dropdown-content a {
      color: #fff;
      padding: 12px 16px;
      text-decoration: none;
      display: block;
    }

    .dropdown-content a:hover {
      background-color: #2c3e50;
    }

    .nav-dropdown:hover .dropdown-content {
      display: block;
    }

    /* Mobile responsive */
    @media (max-width: 768px) {
      .main-nav {
        flex-direction: column;
        gap: 0;
      }
      
      .nav-dropdown {
        width: 100%;
      }
      
      .nav-link {
        width: 100%;
        text-align: left;
        padding: 1rem;
      }
      
      .dropdown-content {
        position: static;
        display: none;
        box-shadow: none;
        background-color: #2c3e50;
      }
      
      .nav-dropdown:hover .dropdown-content,
      .nav-dropdown:focus-within .dropdown-content {
        display: block;
      }
    }

    /* Header */
    .site-header {
      background: #2c3e50;
      color: #fff;
      padding: 1.5rem 1rem;
      margin-bottom: 2rem;
    }

    .header-content {
      max-width: 800px;
      margin: 0 auto;
      text-align: center;
    }

    .site-title {
      font-size: 2.5rem;
      margin: 0 0 0.5rem;
    }

    .site-title a {
      color: #fff;
      text-decoration: none;
    }

    .site-subtitle {
      font-size: 1.2rem;
      color: #ecf0f1;
      margin: 0;
    }

    /* Footer */
    .site-footer {
      background: #2c3e50;
      color: #fff;
      text-align: center;
      padding: 2rem 1rem;
      margin-top: 3rem;
    }

    .site-footer p {
      margin: 0;
    }

    /* Responsive */
    @media (max-width: 640px) {
      .site-title {
        font-size: 1.8rem;
      }
      
      .site-subtitle {
        font-size: 1rem;
      }
      
      .main-nav a {
        display: block;
        margin: 0.5rem 0;
      }
    }
  </style>
  
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-SQ8227MMLV"></script>
  <script is:inline>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-SQ8227MMLV');
  </script>
</head>
<body>
  <header class="site-header">
    <div class="header-content">
      <h1 class="site-title">
        <a href="/">Astrology Bits</a>
      </h1>
      <p class="site-subtitle">The Astrology of Love</p>
    </div>
    <nav class="main-nav">
      <a href="/">Home</a>
      
      <div class="nav-dropdown">
        <button class="nav-link">Signs ▾</button>
        <div class="dropdown-content">
          <a href="/astrological-signs/aries/">Aries</a>
          <a href="/astrological-signs/taurus/">Taurus</a>
          <a href="/astrological-signs/gemini/">Gemini</a>
          <a href="/astrological-signs/cancer">Cancer</a>
          <a href="/astrological-signs/leo">Leo</a>
          <a href="/astrological-signs/virgo">Virgo</a>
          <a href="/astrological-signs/libra">Libra</a>
          <a href="/astrological-signs/scorpio">Scorpio</a>
          <a href="/astrological-signs/sagittarius">Sagittarius</a>
          <a href="/astrological-signs/capricorn">Capricorn</a>
          <a href="/astrological-signs/aquarius">Aquarius</a>
          <a href="/astrological-signs/pisces">Pisces</a>
        </div>
      </div>
      
      <div class="nav-dropdown">
        <button class="nav-link">Houses ▾</button>
        <div class="dropdown-content">
          <a href="/astrological-houses/first-house">First House</a>
          <a href="/astrological-houses/second-house">Second House</a>
          <a href="/astrological-houses/third-house">Third House</a>
          <a href="/astrological-houses/fourth-house">Fourth House</a>
          <a href="/astrological-houses/fifth-house">Fifth House</a>
          <a href="/astrological-houses/sixth-house">Sixth House</a>
          <a href="/astrological-houses/seventh-house">Seventh House</a>
          <a href="/astrological-houses/eighth-house">Eighth House</a>
          <a href="/astrological-houses/ninth-house">Ninth House</a>
          <a href="/astrological-houses/tenth-house">Tenth House</a>
          <a href="/astrological-houses/eleventh-house">Eleventh House</a>
          <a href="/astrological-houses/twelfth-house">Twelfth House</a>
        </div>
      </div>
      
      <div class="nav-dropdown">
        <button class="nav-link">Planets ▾</button>
        <div class="dropdown-content">
          <a href="/planets-in-astrology/sun">Sun</a>
          <a href="/planets-in-astrology/moon">Moon</a>
          <a href="/planets-in-astrology/mercury">Mercury</a>
          <a href="/planets-in-astrology/venus">Venus</a>
          <a href="/planets-in-astrology/mars">Mars</a>
          <a href="/planets-in-astrology/jupiter">Jupiter</a>
          <a href="/planets-in-astrology/saturn">Saturn</a>
          <a href="/planets-in-astrology/uranus">Uranus</a>
          <a href="/planets-in-astrology/neptune">Neptune</a>
          <a href="/planets-in-astrology/pluto">Pluto</a>
        </div>
      </div>
      
      <div class="nav-dropdown">
        <button class="nav-link">Love ▾</button>
        <div class="dropdown-content">
          <a href="/the-astrology-of-love/aries-love">Aries Love</a>
          <a href="/the-astrology-of-love/taurus-love">Taurus Love</a>
          <a href="/the-astrology-of-love/gemini-love">Gemini Love</a>
          <a href="/the-astrology-of-love/cancer-love">Cancer Love</a>
          <a href="/the-astrology-of-love/leo-love">Leo Love</a>
          <a href="/the-astrology-of-love/virgo-love">Virgo Love</a>
          <a href="/the-astrology-of-love/libra-love">Libra Love</a>
          <a href="/the-astrology-of-love/scorpio-love">Scorpio Love</a>
          <a href="/the-astrology-of-love/sagittarius-love">Sagittarius Love</a>
          <a href="/the-astrology-of-love/capricorn-love">Capricorn Love</a>
          <a href="/the-astrology-of-love/aquarius-love">Aquarius Love</a>
          <a href="/the-astrology-of-love/pisces-love">Pisces Love</a>
        </div>
      </div>
    </nav>
  </header>

  <main>
    <slot />
  </main>

  <footer class="site-footer">
    <p>&copy; {new Date().getFullYear()} Astrology Bits. All rights reserved.</p>
  </footer>
</body>
</html>