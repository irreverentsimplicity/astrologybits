---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getAllPages } from '../lib/wordpress';
import { makeLinksRelative } from '../lib/utils';

const pages = await getAllPages();

const homepage = pages.find(p => p.slug === 'welcome') 
               || pages.find(p => p.uri === '/') 
               || pages[0];

if (!homepage) {
  throw new Error('Could not find homepage!');
}

const processedContent = makeLinksRelative(homepage.content);
---

<BaseLayout page={homepage}>
  <div class="wp-content" set:html={processedContent} />
</BaseLayout>